---
export interface Props {
  title: string;
  description?: string;
  image?: string;
  keywords?: string;
  canonical?: string;
  author?: string;
}

const { 
  title, 
  description = "Nutech - Líderes en transformación digital, automatización de procesos (RPA) e inteligencia artificial para empresas en Perú. Especialistas certificados en UiPath, Power Automate y AWS. Optimizamos sus procesos empresariales con soluciones de IA y automatización robótica.", 
  image = "/images/transformacion-digital.webp",
  keywords = "transformación digital, RPA, automatización robótica, inteligencia artificial, UiPath, Power Automate, AWS, Azure, consultoría tecnológica, optimización de procesos, Perú, Lima",
  canonical,
  author = "Nutech"
} = Astro.props;

const baseUrl = Astro.site || 'https://nutech.pe';
const currentUrl = canonical || Astro.url.href;
const ogImage = image.startsWith('http') ? image : `${baseUrl}${image}`;
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    <meta name="author" content={author} />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="googlebot" content="index, follow" />
    <meta name="bingbot" content="index, follow" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={currentUrl} />
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href={`${import.meta.env.BASE_URL}favicon.png`} />
    <link rel="shortcut icon" href={`${import.meta.env.BASE_URL}favicon.png`} />
    <link rel="apple-touch-icon" href={`${import.meta.env.BASE_URL}favicon.png`} />
    
    <!-- Preload Critical Images (WebP with fallback) -->
    <link rel="preload" as="image" href={`${import.meta.env.BASE_URL}images/analisis-datos.webp`} type="image/webp">
    <link rel="preload" as="image" href={`${import.meta.env.BASE_URL}images/capacitacion-ejecutiva.webp`} type="image/webp">
    <link rel="preload" as="image" href={`${import.meta.env.BASE_URL}images/desarrollo-web-mobile.webp`} type="image/webp">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={currentUrl} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Nutech - Transformación Digital y Automatización" />
    <meta property="og:site_name" content="Nutech" />
    <meta property="og:locale" content="es_PE" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={currentUrl} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={ogImage} />
    <meta property="twitter:image:alt" content="Nutech - Transformación Digital y Automatización" />
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#1e40af" />
    <meta name="msapplication-TileColor" content="#1e40af" />
    <meta name="application-name" content="Nutech" />
    <meta name="apple-mobile-web-app-title" content="Nutech" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
      font-src 'self' https://fonts.gstatic.com;
      img-src 'self' data: blob: https:;
      media-src 'self' blob:;
      connect-src 'self' https:;
      frame-src 'none';
      object-src 'none';
      base-uri 'self';
      form-action 'self';
      frame-ancestors 'none';
      upgrade-insecure-requests;
    ">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="
      camera=(),
      microphone=(),
      geolocation=(),
      payment=()
    ">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json" is:inline>
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Nutech",
      "description": "Especialistas en transformación digital, automatización de procesos (RPA) e inteligencia artificial para empresas en Perú",
      "url": "https://nutech.pe",
      "logo": "https://nutech.pe/favicon.png",
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+51-xxx-xxx-xxx",
        "contactType": "customer service",
        "areaServed": "PE",
        "availableLanguage": "Spanish"
      },
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "PE",
        "addressLocality": "Lima"
      },
      "sameAs": [
        "https://www.linkedin.com/company/nutech-peru",
        "https://twitter.com/nutech_peru"
      ],
      "foundingDate": "2020",
      "numberOfEmployees": "10-50",
      "industry": "Information Technology",
      "serviceArea": {
        "@type": "Country",
        "name": "Peru"
      },
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Servicios de Transformación Digital",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Automatización Robótica de Procesos (RPA)",
              "description": "Automatización de procesos empresariales con UiPath, Power Automate y otras herramientas"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Inteligencia Artificial",
              "description": "Implementación de soluciones de IA para optimización empresarial"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Transformación Digital",
              "description": "Consultoría integral para la digitalización de empresas"
            }
          }
        ]
      }
    }
    </script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    
    <!-- Styles -->
    <link rel="stylesheet" href="/src/styles/global.css" />
    <link rel="stylesheet" href="/src/styles/animations.css" />
    <link rel="stylesheet" href="/src/styles/components.css" />
  </head>
  <body class="font-sans antialiased">
    <slot />
    
    <!-- Scripts -->
    <script>
      // Smooth scrolling para enlaces internos
      document.addEventListener('DOMContentLoaded', function() {
        const links = document.querySelectorAll('a[href^="#"]');
        links.forEach(link => {
          link.addEventListener('click', function(this: HTMLAnchorElement, e: Event) {
            e.preventDefault();
            const href = this.getAttribute('href');
            if (href) {
              const target = document.querySelector(href);
              if (target) {
                target.scrollIntoView({
                  behavior: 'smooth',
                  block: 'start'
                });
              }
            }
          });
        });
      });
    </script>
  </body>
</html>
